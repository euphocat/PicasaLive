(function(a){function g(){var a=new Array(-1,1);return a[Math.round(Math.random())]}function f(a){if(typeof a=="string"){if(a[a.length-1]=="c"||a[a.length-1]=="c"){return a.substring(0,a.length-1)}}return a}function e(a){for(var b,c,d=a.length;d;b=parseInt(Math.random()*d),c=a[--d],a[d]=a[b],a[b]=c);return a}function d(a){return Math.floor(Math.random()*a)}var b={idGallery:null,user:null,speed:2e3,thumbsize:200,imgmax:800,style:null,shuffle:false,animate:null};var c=function(){};c.prototype={$elem:null,images:new Array,opts:null,frame:null,currentThumb:0,turns:0,interval:null,_parseJSON:function(){var b=this;var c="http://picasaweb.google.com/data/feed/api/user/"+this.opts.user+"/albumid/"+this.opts.idGallery+"?alt=json&kind=photo&hl=fr&thumbsize="+this.opts.thumbsize+"&imgmax="+this.opts.imgmax;a.ajax({url:c,dataType:"jsonp",success:function(c){a(c.feed.entry).each(function(){var a={big:this.media$group.media$content[0].url,mini:this.media$group.media$thumbnail[0].url};b.images.push(a)});if(b.opts.shuffle){b.images=e(b.images)}b._display()},error:function(){}})},_display:function(){this.frame.html("");this._loadAnImage();this._launchAnimation()},_loadAnImage:function(){var b=Math.floor((Math.random()*2-1)*30);var c=f(this.opts.thumbsize)/2;var e=a("<a href='"+this.images[this.currentThumb]["big"]+"' rel='gallery'><img src='"+this.images[this.currentThumb]["mini"]+"' alt='script Picasa live'></a>").appendTo(this.frame).css({marginTop:this.frame.height()/2-c+g()*d(this.frame.height()/3)+"px",marginLeft:this.frame.width()/2-c+g()*d(this.frame.width()/3)+"px"});if(this.opts.animate=="slide"){e.css({marginTop:"-"+this.frame.height()/16+"em"}).animate({marginTop:"+="+(this.frame.height()/16+d(this.frame.height()/16))+"em",rotate:b+"deg"})}else if(this.opts.animate=="fadein"){e.css({opacity:0,rotate:b+"deg"}).animate({opacity:1})}else if(this.opts.animate=="elastic"){e.css({scale:[0,0]}).animate({scale:[1,1],rotate:b+"deg"},"slow","easeOutElastic")}else{e.css({rotate:b+"deg"})}if(this.turns>0){this.frame.find("img:first").fadeOut(200,function(){a(this).remove()})}if(this.currentThumb<this.images.length-1){this.currentThumb++}else{this.currentThumb=0;this.turns++}},_launchAnimation:function(){var a=this;this.interval=setInterval(function(){a._loadAnImage()},this.opts.speed)}};var h={init:function(d){return this.each(function(){var e=new c;e.$elem=this;e.frame=a("<div class='picasalive'></div>").appendTo(e.$elem);e.opts=a.extend(b,d);if(e.opts.style=="polaroid"){e.frame.addClass("picasalive-polaroid");e.opts.thumbsize="160c"}e._parseJSON();a(this).data("picasalive",e)})},stop:function(){return this.each(function(){var b=a(this).data("picasalive");if(b){window.clearInterval(b.interval)}})},play:function(){return this.each(function(){var b=a(this).data("picasalive");if(b){b._launchAnimation()}})},changeAnimation:function(b){return this.each(function(){var c=a(this).data("picasalive");if(c){c.opts.animate=b}})}};a.fn.picasalive=function(b){if(h[b]){return h[b].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof b==="object"||!b){return h.init.apply(this,arguments)}else{a.error("Method "+b+" doesn't exist in PicasaLive")}return a(this)}})(jQuery)